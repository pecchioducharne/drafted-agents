name: Redaction Rules
description: Patterns and rules for redacting sensitive information

patterns:
  api_keys:
    - regex: "(?i)(api[_-]?key|apikey)\\s*[:=]\\s*['\"]?([a-zA-Z0-9_\\-]{20,})['\"]?"
      replacement: "API_KEY_REDACTED"
    
  tokens:
    - regex: "(?i)(token|bearer|auth)\\s*[:=]\\s*['\"]?([a-zA-Z0-9_\\-\\.]{20,})['\"]?"
      replacement: "TOKEN_REDACTED"
    
  passwords:
    - regex: "(?i)(password|passwd|pwd)\\s*[:=]\\s*['\"]?([^'\"\\s]{6,})['\"]?"
      replacement: "PASSWORD_REDACTED"
    
  github_tokens:
    - regex: "ghp_[a-zA-Z0-9]{36}"
      replacement: "GITHUB_TOKEN_REDACTED"
    - regex: "github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59}"
      replacement: "GITHUB_PAT_REDACTED"
    
  slack_tokens:
    - regex: "xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24,32}"
      replacement: "SLACK_TOKEN_REDACTED"
    
  aws_keys:
    - regex: "AKIA[0-9A-Z]{16}"
      replacement: "AWS_ACCESS_KEY_REDACTED"
    - regex: "(?i)aws_secret_access_key\\s*[:=]\\s*['\"]?([a-zA-Z0-9/+=]{40})['\"]?"
      replacement: "AWS_SECRET_KEY_REDACTED"
    
  private_keys:
    - regex: "-----BEGIN (RSA |EC |DSA )?PRIVATE KEY-----[\\s\\S]+?-----END (RSA |EC |DSA )?PRIVATE KEY-----"
      replacement: "PRIVATE_KEY_REDACTED"
    
  emails:
    - regex: "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
      replacement: "EMAIL_REDACTED"
      exceptions:
        - "noreply@"
        - "support@"
        - "no-reply@"
    
  ip_addresses:
    - regex: "\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"
      replacement: "IP_REDACTED"
      exceptions:
        - "127.0.0.1"
        - "0.0.0.0"
        - "localhost"

file_patterns:
  always_redact:
    - ".env"
    - ".env.local"
    - ".env.production"
    - "credentials.json"
    - "service-account.json"
    - "*.pem"
    - "*.key"
    - "*.p12"
    - "*.pfx"
  
  never_log:
    - ".env"
    - "credentials.json"
    - "*-service-account.json"
    - "*.pem"
    - "*.key"

logging_rules:
  redact_in_logs: true
  redact_in_artifacts: true
  redact_in_pr_descriptions: true
  redact_in_slack_messages: true
  
  audit_trail:
    log_redactions: true
    alert_on_sensitive_data: true
